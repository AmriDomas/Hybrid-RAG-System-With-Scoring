{
  "title": "RAG System - Complete Monitoring",
  "timezone": "browser",
  "panels": [
    {
      "id": 1,
      "title": "Query Rate & Volume",
      "type": "graph",
      "gridPos": {"h": 8, "w": 12, "x": 0, "y": 0},
      "targets": [
        {
          "expr": "rate(rag_queries_total[5m])",
          "legendFormat": "{{retrieval_method}}",
          "refId": "A"
        }
      ],
      "yaxes": [
        {"label": "Queries/sec", "format": "ops"},
        {"format": "short"}
      ]
    },
    {
      "id": 2,
      "title": "Response Latency (seconds)",
      "type": "graph", 
      "gridPos": {"h": 8, "w": 12, "x": 12, "y": 0},
      "targets": [
        {
          "expr": "rate(rag_total_duration_seconds_sum[5m]) / rate(rag_total_duration_seconds_count[5m])",
          "legendFormat": "Average",
          "refId": "A"
        },
        {
          "expr": "histogram_quantile(0.95, rate(rag_total_duration_seconds_bucket[5m]))",
          "legendFormat": "P95",
          "refId": "B"
        }
      ],
      "yaxes": [
        {"label": "Seconds", "format": "s"},
        {"format": "short"}
      ]
    },
    {
      "id": 3,
      "title": "Token Usage",
      "type": "graph",
      "gridPos": {"h": 8, "w": 12, "x": 0, "y": 8},
      "targets": [
        {
          "expr": "rate(rag_tokens_total[5m])",
          "legendFormat": "Tokens/sec",
          "refId": "A"
        }
      ],
      "yaxes": [
        {"label": "Tokens/sec", "format": "ops"},
        {"format": "short"}
      ]
    },
    {
      "id": 4,
      "title": "Documents Retrieved",
      "type": "graph",
      "gridPos": {"h": 8, "w": 12, "x": 12, "y": 8},
      "targets": [
        {
          "expr": "rate(rag_documents_retrieved_sum[5m]) / rate(rag_documents_retrieved_count[5m])",
          "legendFormat": "Avg Documents/Query",
          "refId": "A"
        }
      ],
      "yaxes": [
        {"label": "Documents", "format": "short"},
        {"format": "short"}
      ]
    },
    {
      "id": 5,
      "title": "Quality Metrics",
      "type": "graph",
      "gridPos": {"h": 8, "w": 12, "x": 0, "y": 16},
      "targets": [
        {
          "expr": "rag_generation_faithfulness",
          "legendFormat": "Faithfulness",
          "refId": "A"
        },
        {
          "expr": "rag_generation_relevance", 
          "legendFormat": "Relevance",
          "refId": "B"
        }
      ],
      "yaxes": [
        {"label": "Score", "format": "percentunit", "min": 0, "max": 1},
        {"format": "short"}
      ]
    },
    {
      "id": 6,
      "title": "Active Queries",
      "type": "stat",
      "gridPos": {"h": 4, "w": 6, "x": 12, "y": 16},
      "targets": [
        {
          "expr": "rag_active_queries",
          "legendFormat": "Active",
          "refId": "A"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "color": {"mode": "thresholds"},
          "thresholds": {
            "steps": [
              {"value": null, "color": "green"},
              {"value": 5, "color": "yellow"},
              {"value": 10, "color": "red"}
            ]
          }
        }
      }
    },
    {
      "id": 7,
      "title": "Indexed Documents",
      "type": "stat", 
      "gridPos": {"h": 4, "w": 6, "x": 18, "y": 16},
      "targets": [
        {
          "expr": "rag_indexed_documents",
          "legendFormat": "Documents",
          "refId": "A"
        }
      ]
    }
  ],
  "refresh": "10s"
}